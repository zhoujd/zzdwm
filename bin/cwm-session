#!/bin/bash

log=$HOME/.cwm-errors
kind=run

opt=(
    "VBoxClient-all"
    "blackwalls"
    "shotkey"
    "xbanish"
    "xcompmgr"
)

spawn() {
    local cmd=$1
    if [ -n "$(which $cmd)" ]; then
        echo "$(date) cwm: spawn $cmd." >>$log
        $cmd >/dev/null 2>&1 || true
    fi
}

run() {
    echo "$(date) cwm: start cwm on run mode." >$log
    echo "$(date) dwm: start applications." >>$log
    for i in "${opt[@]}"; do
        spawn $i &
    done
    exec cwm >/dev/null 2>&1
}

debug() {
    echo "$(date) cwm: start cwm on debug mode." >$log
    echo "$(date) dwm: start applications." >>$log
    for i in "${opt[@]}"; do
        spawn $i &
    done
    exec cwm >>$log 2>&1
}

case $kind in
    run|-r )
        run
        ;;
    debug|-d )
        debug
        ;;
esac

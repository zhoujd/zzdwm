#!/bin/bash

log=$HOME/.dwm-errors
kind=run

opt=(
    "VBoxClient-all"
)

spawn() {
    local cmd=$1
    if [ -n "$(which $cmd)" ]; then
        echo "$(date) dwm: spawn $cmd." >>$log
        $cmd >/dev/null 2>&1 || true
    fi
}

init() {
    rm -rf $log
    for i in "${opt[@]}"; do
        spawn $i &
    done
}

run() {
    echo "$(date) dwm: start dwm on run mode." >>$log
    exec dwm >/dev/null 2>&1
}

debug() {
    echo "$(date) dwm: start dwm on debug mode." >>$log
    exec dwm >>$log 2>&1
}

case $kind in
    run|-r )
        init
        run
        ;;
    debug|-d )
        init
        debug
        ;;
esac

#!/bin/bash

log=$HOME/.cwm-errors
kind=run

opt=(
    "VBoxClient-all"
    "blackwalls"
    "shotkey"
    "xbanish"
    "xcompmgr"
)

start() {
    local cmd=$1
    if [ -n "$(which $cmd)" ]; then
        $cmd >/dev/null 2>&1 || true
        echo "$(date) $app: run $cmd success." >>$log
    fi
}

init() {
    rm -rf $log
    for i in "${opt[@]}"; do
        start $i &
    done
}

run() {
    echo "$(date) cwm: start cwm on run mode." >>$log
    exec cwm >/dev/null 2>&1
}

debug() {
    echo "$(date) cwm: start cwm on debug mode." >>$log
    exec cwm >>$log 2>&1
}

case $kind in
    run|-r )
        init
        run
        ;;
    debug|-d )
        init
        debug
        ;;
esac
